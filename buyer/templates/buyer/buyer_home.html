{% extends './buyer_base.html' %}
{% load static %}


{% block content %}
{% if messages %}
    {% for message in messages %}
        <p id="message" style="{% if message.tags == 'success' %}color:green{% endif %}" class="color:red">{{ message }}</p>
    {% endfor %}
{% endif %}
<div class="container mx-auto px-4 py-8">
    <!-- Search Results Section -->
    {% if query %}
    <div class="mb-12">
        <h2 class="text-2xl font-bold mb-6">Search Results for "{{ query }}"</h2>
        {% if search_results %}
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            {% for product in search_results %}
            <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300">
                <a href="{% url 'product-detail' pk=product.id %}">
                    <div class="relative">
                        <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-48 object-cover">
                        <span class="absolute top-2 left-2 bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">
                            {{ product.category.name }}
                        </span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-lg mb-1">{{ product.name }}</h3>
                        <p class="text-gray-600 text-sm mb-2">{{ product.brand_name }}</p>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-teal-700">₹{{ product.base_price }}</span>
                            {% if product.avg_rating %}
                            <span class="flex items-center text-sm text-yellow-500">
                                ★ {{ product.avg_rating|floatformat:1 }}
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-8">
            <p class="text-gray-600 mb-4">No products found matching your search.</p>
            <p class="text-sm text-gray-500">Try different keywords or browse our categories:</p>
            <div class="flex flex-wrap justify-center gap-2 mt-4">
                {% for category in categories %}
                <a href="{% url 'category_products' slug=category.slug %}" 
                class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-sm">
                    {{ category.name }}
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    {% endif %}

</div>
    <main class="px-4 sm:px-6 md:px-10 max-w-[1200px] mx-auto mt-6 mb-16"> <!-- Banner -->
        <!-- slider -->
        <section class="relative rounded-xl overflow-hidden bg-teal-700 text-white max-w-full h-[140px] sm:h-[160px] md:h-[180px] lg:h-[200px]">
            <!-- Decorative Circles -->
            <img src="https://placehold.co/300x300/2c7a82/2c7a82?text=Circle+Decor" alt="Decorative teal circles"
              class="absolute top-0 right-0 w-[180px] h-[180px] md:w-[220px] md:h-[220px] opacity-30 rounded-full" />
            <img src="https://placehold.co/120x120/2c7a82/2c7a82?text=Circle+Decor" alt="Decorative teal circle"
              class="absolute bottom-0 left-10 w-[80px] h-[80px] md:w-[100px] md:h-[100px] opacity-30 rounded-full" />
          
            <!-- Slides Container -->
            <div id="carouselSlides" class="flex transition-transform duration-500 ease-in-out w-[300%] h-full">
              
              <!-- Slide 1: New Arrivals -->
              <div class="w-full flex-shrink-0 flex items-center justify-between px-6 sm:px-10 relative">
                <img src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=500&q=80"
                  alt="New Arrivals background"
                  class="absolute inset-0 w-full h-full object-cover opacity-20 z-0" />
                <div class="relative z-10 max-w-[60%] sm:max-w-[70%] md:max-w-[60%]">
                  <p class="text-sm sm:text-base font-normal mb-1">Best Deal Online on Sentimart</p>
                  <h2 class="text-2xl sm:text-3xl md:text-4xl font-normal leading-tight mb-1">New Arrivals</h2>
                  <p class="text-sm sm:text-base font-normal">UP to 80% OFF</p>
                  <div class="mt-2 flex space-x-1 text-lg font-bold">••••</div>
                </div>
              </div>
          
              <!-- Slide 2: Top Electronics -->
              <div class="w-full flex-shrink-0 flex items-center justify-between px-6 sm:px-10 relative">
                <img src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=500&q=80"
                  alt="Electronics background"
                  class="absolute inset-0 w-full h-full object-cover opacity-20 z-0" />
                <div class="relative z-10 max-w-[60%] sm:max-w-[70%] md:max-w-[60%]">
                  <p class="text-sm sm:text-base font-normal mb-1">Trending Now</p>
                  <h2 class="text-2xl sm:text-3xl md:text-4xl font-normal leading-tight mb-1">Top Electronics</h2>
                  <p class="text-sm sm:text-base font-normal">Save Big This Week</p>
                  <div class="mt-2 flex space-x-1 text-lg font-bold">••••</div>
                </div>
              </div>
          
              <!-- Slide 3: Fashion Picks -->
              <div class="w-full flex-shrink-0 flex items-center justify-between px-6 sm:px-10 relative">
                <img src="https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?auto=format&fit=crop&w=500&q=80"
                  alt="Fashion Picks background"
                  class="absolute inset-0 w-full h-full object-cover opacity-20 z-0" />
                <div class="relative z-10 max-w-[60%] sm:max-w-[70%] md:max-w-[60%]">
                  <p class="text-sm sm:text-base font-normal mb-1">Exclusive Deals</p>
                  <h2 class="text-2xl sm:text-3xl md:text-4xl font-normal leading-tight mb-1">Fashion Picks</h2>
                  <p class="text-sm sm:text-base font-normal">Up to 50% OFF</p>
                  <div class="mt-2 flex space-x-1 text-lg font-bold">••••</div>
                </div>
              </div>
            </div>
          
            <!-- Navigation Buttons -->
            <button onclick="prevSlide()" aria-label="Previous"
              class="absolute left-2 top-1/2 -translate-y-1/2 bg-white w-10 h-10 rounded-full flex items-center justify-center text-teal-700 shadow-md hover:bg-teal-50 z-20">
              <i class="fas fa-chevron-left"></i>
            </button>
            <button onclick="nextSlide()" aria-label="Next"
              class="absolute right-2 top-1/2 -translate-y-1/2 bg-white w-10 h-10 rounded-full flex items-center justify-center text-teal-700 shadow-md hover:bg-teal-50 z-20">
              <i class="fas fa-chevron-right"></i>
            </button>
          </section>
          
          <script>
            let currentIndex = 0;
            const slideContainer = document.getElementById("carouselSlides");
            const totalSlides = 3;
          
            function updateSlide() {
              slideContainer.style.transform = `translateX(-${currentIndex * 100}%)`;
            }
          
            function nextSlide() {
              currentIndex = (currentIndex + 1) % totalSlides;
              updateSlide();
            }
          
            function prevSlide() {
              currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
              updateSlide();
            }
          
            // Auto-slide every 4 seconds
            setInterval(nextSlide, 4000);
          </script>

        <!-- recommented products section -->
        {% if request.user.is_authenticated and personalized_products %}
        <h2>Recommended For You</h2>
        <ul class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4" role="list"
            aria-label="Recommended products">
            {% for product in personalized_products %}
            <a href="{% url 'product-detail' product.id  %}">
                <li class="border border-gray-200 rounded-lg p-2 flex flex-col items-center text-center relative transition duration-300 hover:border-2 hover:border-[#008ECC] hover:shadow-md hover:-m-[1px]"
                    tabindex="0">
                    <div class="mb-2 w-full h-[210px] overflow-hidden flex items-center justify-center">
                        <img src="{{ product.image.url }}"
                            alt="{{ product.name }}"
                            class="w-auto h-[200px] object-contain scale-125" />
                    </div>
                    <div class="text-xs font-semibold mb-0.5">{{ product.name }}</div>
                    <div class="text-xs text-gray-500 line-through mb-0.5">₹{{product.base_price}}</div>
                    <div class="text-sm font-bold mb-1">₹{{ product.discount }}</div>
                    <div class="text-xs text-green-600">Save - ₹{{ product.saved_amount|floatformat:0 }}</div>
                    <div class="absolute top-0 right-0 bg-[#0095D9] text-white text-xs font-semibold px-3 py-2 rounded-bl-[20px] leading-tight text-center">
                        {{ product.discount_percentage|floatformat:0 }}%<br>OFF
                    </div>
                </li>
            </a>
            {% endfor %}
        </ul>
        {% endif %}
        
        <!-- Smartphones Section -->
        <section class="mt-10">
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-sm sm:text-base font-normal"> Grab the best deal on <a href="#"
                        class="text-blue-600 hover:underline">Smartphones</a> </h3> <a href="#"
                    class="text-xs text-teal-700 flex items-center space-x-1 hover:underline"> <span>View All</span> <i
                        class="fas fa-chevron-right text-xs"></i> </a>
            </div>
            <hr class="border-blue-600 border-b-2 w-20 mb-4" />
            <ul class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4" role="list"
                aria-label="Smartphones products"> <!-- Product 1 -->
                {% for phone in smart_phones %}
                <a href="{% url 'product-detail' pk=phone.id  %}">
                <li class="border border-gray-200 rounded-lg p-2 flex flex-col items-center text-center relative transition duration-300 hover:border-2 hover:border-[#008ECC] hover:shadow-md hover:-m-[1px]"
                    tabindex="0">
                    <div class="mb-2 w-full h-[210px] overflow-hidden flex items-center justify-center">
                        <img src="{{ phone.image.url }}"
                            alt="Galaxy M13 smartphone front view with brown background"
                            class="w-auto h-[200px] object-contain scale-125" />
                    </div>
                    <div class="text-xs font-semibold mb-0.5">{{ phone.name }}</div>
                    <div class="text-xs text-gray-500 line-through mb-0.5">₹{{phone.base_price}}</div>
                    <div class="text-sm font-bold mb-1">₹{{ phone.discount }}</div>
                    <div class="text-xs text-green-600">Save - ₹{{ phone.saved_amount|floatformat:0 }}</div>
                    <div class="absolute top-0 right-0 bg-[#0095D9] text-white text-xs font-semibold px-3 py-2 rounded-bl-[20px] leading-tight text-center">
                        {{ phone.discount_percentage|floatformat:0 }}%<br>OFF
                    </div>
                </li>
                </a>
                {% endfor %}
            </ul>
        </section> 
        <!-- Top Categories -->
        <section class="mt-10">
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-sm sm:text-base font-normal">Shop From <a href="#"
                        class="text-blue-600 hover:underline">Top Categories</a></h3>
                <a href="#" class="text-xs text-teal-700 flex items-center space-x-1 hover:underline">
                    <span>View All</span>
                    <i class="fas fa-chevron-right text-xs"></i>
                </a>
            </div>
            <hr class="border-blue-600 border-b-2 w-20 mb-4" />
            <ul class="flex space-x-6 overflow-x-auto pb-4" role="list" aria-label="Top categories">
                {% for category in categories %}
                <a href="{% url 'category_products' slug=category.slug %}">
                  <li class="flex flex-col items-center space-y-2 min-w-[140px] group">
                      <div class="rounded-full border-2 border-transparent p-1 transition duration-300 group-hover:border-[#008ECC]">
                          <div class="rounded-full bg-gray-100 p-3 flex items-center justify-center w-20 h-20">
                              <img src="{{ category.image.url }}"
                                  alt="Mobile phone front view in blue color" class="w-16 h-16 object-contain" />
                          </div>
                      </div>
                      <span class="text-sm font-medium text-center">{{ category.name }}</span>
                  </li>
                </a>
                {% endfor %}
            </ul>
        </section> 
        <!-- Electronics Brands -->
         <!-- <section class="mt-12">
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-sm sm:text-base font-normal"> Top <a href="#"
                        class="text-blue-600 hover:underline">Electronics Brands</a> </h3> 
                <a href="#" class="text-xs text-teal-700 flex items-center space-x-1 hover:underline">
                    <span>View All</span> 
                    <i class="fas fa-chevron-right text-xs"></i>
                </a>
            </div>
            <hr class="border-blue-600 border-b-2 w-28 mb-4" />
            <div class="flex space-x-6 overflow-x-auto pb-4 h-auto w-full sm:w-[90vw] lg:w-[78vw] snap-x scroll-smooth">
        
                <div class="flex-shrink-0 snap-start rounded-lg bg-gray-800 text-white p-4 w-[70vw] sm:w-[40vw] lg:w-[24vw] h-[220px] flex items-center justify-between shadow-lg"
                    tabindex="0" aria-label="Apple brand with up to 80% off">
                    <div class="flex flex-col justify-between h-full">
                        <div>
                            <div class="text-xs bg-gray-700 rounded px-2 py-1 mb-1 inline-block font-semibold">IPHONE</div>
                            <div class="rounded-lg p-1 w-8 h-8 flex items-center justify-center mt-auto" style="background-color: #FFFFFF;">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg" 
                                     alt="Apple logo" 
                                     class="w-5 h-6" />
                            </div>
                            <div class="text-sm font-semibold">UP to 80% OFF</div>
                        </div>
                    </div>
                    
                    <img src="https://pngimg.com/uploads/iphone16/iphone16_PNG38.png"
                        alt="Apple iPhone 13 Pro smartphone front view" class="max-w-[100px] h-auto object-contain" />
                </div>
            
         
                <div class="flex-shrink-0 snap-start rounded-lg bg-yellow-50 p-4 w-[70vw] sm:w-[40vw] lg:w-[24vw] h-[220px] flex items-center justify-between shadow-lg"
                    tabindex="0" aria-label="Realme brand with up to 80% off">
                    <div class="flex flex-col justify-between h-full">
                        <div>
                            <div class="text-xs bg-yellow-200 rounded px-2 py-1 mb-1 inline-block font-semibold text-yellow-900">REALME</div>
                            <div class="bg-yellow-200 rounded-lg flex items-center justify-center mt-auto">
                                <img src="{% static 'images/realme.png' %}" 
                                     alt="Realme logo" 
                                     class="w-6 h-6" />
                            </div>
                            <div class="text-sm font-semibold">UP to 80% OFF</div>
                        </div>
                    </div>
                    <img src="{% static 'images/image 9.png' %}"
                        alt="Realme smartphone front view" class="max-w-[100px] h-auto object-contain" />
                </div>
            
              
                <div class="flex-shrink-0 snap-start rounded-lg bg-orange-50 p-4 w-[70vw] sm:w-[40vw] lg:w-[24vw] h-[220px] flex items-center justify-between shadow-lg"
                    tabindex="0" aria-label="Xiaomi brand with up to 80% off">
                    <div class="flex flex-col justify-between h-full">
                        <div>
                            <div class="text-xs bg-orange-200 rounded px-2 py-1 mb-1 inline-block font-semibold text-orange-900">XIAOMI</div>
                            <div class="bg-orange-200 rounded-lg p-1 w-8 h-8 flex items-center justify-center mt-auto">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/a/ae/Xiaomi_logo_%282021-%29.svg" 
                                     alt="Xiaomi logo" 
                                     class="w-6 h-6" />
                            </div>
                            <div class="text-sm font-semibold">UP to 80% OFF</div>
                        </div>
                    </div>
                    <img src="{% static 'images/realme_phone.png' %}"
                        alt="Xiaomi smartphone front view" class="max-w-[100px] h-auto object-contain" />
                </div>
            </div>
            
            <div class="w-20 h-1 bg-teal-600 rounded-full mt-2 mx-auto"></div>
        </section>  -->
        <!-- Smartwatches Section -->
        <section class="mt-10">
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-sm sm:text-base font-normal"> Grab the best deal on <a href="#"
                        class="text-blue-600 hover:underline">Smartwatchs</a> </h3> 
                <a href="#"
                    class="text-xs text-teal-700 flex items-center space-x-1 hover:underline"> 
                    <span>View All</span> 
                    <i class="fas fa-chevron-right text-xs"></i> 
                </a>
            </div>
            <hr class="border-blue-600 border-b-2 w-28 mb-4" />
            <ul class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4" role="list"
                aria-label="Smartwatches products">
                <!-- Smartwatch 1 -->
                 {% for smartwatch in smart_watches %}
                 <a href="{% url 'product-detail' pk=smartwatch.id  %}">
                <li class="border border-gray-200 rounded-lg p-2 flex flex-col items-center text-center relative transition duration-300 hover:border-2 hover:border-[#008ECC] hover:shadow-md hover:-m-[1px]"
                    tabindex="0"> 
                    <img src="{{ smartwatch.image.url }}"
                        alt=""
                        class="mb-2 w-[120px] h-[120px] object-contain" />
                    <div class="text-xs font-semibold mb-0.5">{{ smartwatch.name }}</div>
                    <div class="text-xs text-gray-500 line-through mb-0.5">₹{{ smartwatch.base_price }}</div>
                    <div class="text-sm font-bold mb-1">₹{{ smartwatch.discount }}</div>
                    <div class="text-xs text-green-600">Save - ₹{{ smartwatch.saved_amount|floatformat:0 }}</div>
                    <div class="absolute top-0 right-0 bg-[#0095D9] text-white text-xs font-semibold px-3 py-2 rounded-bl-[20px] leading-tight text-center">
                        {{ smartwatch.discount_percentage|floatformat:0 }}%<br>OFF</div>
                </li>
                </a>
                {% endfor %}
            </ul>
        </section>
        <!-- Best Seller Banner -->
        {% if best_seller %}
        <section class="mt-10 rounded-xl bg-yellow-100 p-6 flex flex-col sm:flex-row items-center justify-between max-w-full"
            aria-label="Best seller {{ best_seller.name }} with up to {{ best_seller.discount_percentage|floatformat:0 }}% off">
            <div class="max-w-[60%] sm:max-w-[50%] mb-4 sm:mb-0">
                <p class="text-sm font-normal mb-1">Best seller</p>
                <h2 class="text-xl sm:text-2xl font-normal mb-1">{{ best_seller.name|upper }}</h2>
                <p class="text-sm font-normal mb-3">UP to {{ best_seller.discount_percentage|floatformat:0 }}% OFF</p>
                <a href="{% url 'product-detail' pk=best_seller.id %}" 
                class="text-xs font-normal border border-gray-600 rounded-full px-3 py-1 hover:bg-gray-200 inline-block">
                    View more
                </a>
            </div>
            <img src="{{ best_seller.image.url }}"
                alt="{{ best_seller.name }}"
                class="w-[160px] h-[160px] object-contain" />
        </section>
        {% endif %}
    </main>

{% endblock %}
    