{% extends 'admin_base.html' %}
{% load static %}
{% block content %}

<!-- Messages display -->
{% if messages %}
<div class="px-6 py-3">
    {% for message in messages %}
    <div class="{% if message.tags == 'error' %}bg-red-100 text-red-700{% else %}bg-green-100 text-green-700{% endif %} text-sm p-3 rounded mb-4">
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}

</aside>
<!-- Main content -->
<main class="flex-1 flex flex-col">
 <!-- Header -->
 <header class="border-b border-gray-300 shadow-md px-6 py-3 flex items-center">
  <h1 class="text-[#4a7a81] font-semibold text-lg">
   Edit Category
  </h1>
 </header>
 <!-- Content -->
 <section class="flex-1 overflow-auto px-6 py-10">
  <h2 class="text-[#4a7a81] font-semibold text-2xl text-center mb-10 capitalize">
   Edit Category
  </h2>
  <form class="max-w-xl mx-auto flex flex-col gap-6" method="post" enctype="multipart/form-data">
    {% csrf_token %}
   <div class="text-center font-semibold text-base">
    Edit Category
   </div>
   <div class="flex flex-col gap-1">
    <label class="text-sm font-normal" for="categoryName">
     Category name
    </label>
    <input class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#4a7a81]" 
           name="name" 
           id="categoryName" 
           type="text"
           value="{{ category.name }}"/>
    {% if errors.name %}
      <p class="text-red-500 text-xs mt-1">{{ errors.name }}</p>
    {% endif %}
   </div>
   <div class="flex flex-col gap-1">
    <label class="text-sm font-normal" for="categoryImage">
     Category image
    </label>
    <div class="relative">
     <label class="cursor-pointer border border-gray-300 rounded-lg p-8 flex justify-center items-center absolute top-0 left-0 w-full h-full" for="categoryImage">
      <i class="fas fa-upload text-3xl text-gray-600">
      </i>
     </label>
     <input accept="image/*" class="hidden" name="image" id="categoryImage" type="file" 
            onchange="document.getElementById('categoryImagePreview').src = window.URL.createObjectURL(this.files[0])"/>
     <img id="categoryImagePreview" class="h-48 w-auto mx-auto" src="{{ category.image.url }}" alt="Current category image"/>
     {% if errors.image %}
      <p class="text-red-500 text-xs mt-1">{{ errors.image }}</p>
     {% endif %}
     <p class="text-xs text-gray-500 mt-2">Current image. Upload new image to change.</p>
    </div>
   </div>
   <div class="flex gap-4 justify-center">
    <button class="bg-[#4a7a81] text-black rounded-lg py-3 px-10" type="submit">
     Save Changes
    </button>
    <a href="{% url 'add_category' %}" class="bg-gray-300 text-black rounded-lg py-3 px-10 inline-block">
     Cancel
    </a>
   </div>
  </form>
 </section>
</main>
</div>

<script>
// Show current image by default
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('categoryImagePreview').src = "{{ category.image.url }}";
});
</script>

{% endblock %}